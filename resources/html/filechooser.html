<html>
	<head>
	<script src="jquery-1.11.1.min.js"></script>
	<script>
		$(document).ready(function(){
			var Ti = window.parent.Ti;
			var callback;
			Ti.App.addEventListener("app:fromTitanium", function(e) {
				callback=e.callback;
				$('.imagefile').click();
			});
			$('.imagefile').change(function(e){
				var formData = new FormData();
				var files = e.target.files;
				console.log(formData);
				$.each(files, function(key, value){
					formData.append("uploadimage", value);	
				});
				formData.append("appid", "2");
				formData.append("imagename", "categoryIcon1");
				//var url = "http://localhost:4000";
<<<<<<< HEAD
				var	url = "http://104.131.69.224:4000";
=======
				var	url = "http://162.222.227.147:4000";
>>>>>>> FETCH_HEAD
				
				 $.ajax({
					url : url+"/uploadfile",
					type: 'POST',
					data:  formData,
					processData: false,
    				contentType: false,
					success: function(response, textStatus, jqXHR){
						setTimeout(function(){
							callback(url+response.image.filepath);
						},  5000);
						//Ti.App.fireEvent('app:fromWebView', { message: "http://localhost:4000/"+response.image.filepath });	
					},
					error: function(jqXHR, textStatus, errorThrown){
						
					}         
				}); 
			});
		});
	</script>
	</head>
	<body>
		<input type="file" name="myfile" class="imagefile" style="display:none"/>
	</body>
</html>